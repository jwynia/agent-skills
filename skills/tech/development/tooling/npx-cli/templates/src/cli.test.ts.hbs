import { describe, it, expect } from 'vitest';
import { execFile } from 'node:child_process';
import { promisify } from 'node:util';

const exec = promisify(execFile);

describe('CLI', () => {
	it('prints help with --help', async () => {
		const { stdout } = await exec('node', ['./dist/cli.js', '--help']);
		expect(stdout).toContain('{{binName}}');
	});

	it('prints version with --version', async () => {
		const { stdout } = await exec('node', ['./dist/cli.js', '--version']);
		expect(stdout).toContain('0.0.0');
	});

	it('processes positional input', async () => {
		const { stdout } = await exec('node', ['./dist/cli.js', 'hello']);
		expect(stdout).toContain('Processing: hello');
	});
});
